# PL-SQL-Test-Tasks
Какое то старое тестовое задание на должность pl/sql dev

* [del.sql](del.sql) - удаление всех созданных таблиц, процедур, функций
* [table.sql](table.sql) - создание таблиц, индексов, последовательностей
* [cp_first.sql](cp_first.SQL) - создание функций:
    * поиск мероприятия по названию и коду
    * поиск мероприятия-родителя
    * наличие конкретного мероприятия (для того, чтобы не считывать построчно всю таблицу)
    * проверка мероприятия на наличие потомков
    * количество прямых потомков мероприятия
    * количество участников в мероприятии
    * наличие данного участника в мероприятии
    * сумма "братьев" - сумма для мероприятий, у которых общий родитель за минусом суммы текущего мероприятия
    * сумма потомков
    * сумма родителя
    * функция доступной суммы для обновления с учетом сумм родителей
    * проверка на корректную сумму мероприятий
    * проверка даты начала
    * проверка даты конца

* [cp_second.sql](cp_second.sql) - создание процедур
    * добавление мероприятия
    * удаление мероприятия(недоделано)
    * обновление суммы в мероприятии
    * добавление участника в мероприятие
    * удаление участника из мероприятия(недоделано)
    * обновление участника в мероприятии(недоделано)

Из всего что сделал на данный момент недоделал:
  * удаление мероприятия - недоделал следующее:
    * при удалении какого либо мероприятия-узла, если у родителя текущего мероприятия 2 потомка,
    * мероприятие -"брат" и все его потомки поднимаются на 1 уровень выше по дереву.
    * например есть  мероприятия
      * **1.1**
      * **1.1.1**  ____**1.1.2**
      * **1.1.1.1**____**1.1.1.2**____**1.1.2.1**____**1.1.2.2**
      * при удалении 1.1.1 удалится и 1.1.1.1 и 1.1.1.2 и	1.1.2 перейдет в 1.1, 1.1.2.1 и 1.1.2.2 перейдут в 1.1.1 1.1.2

  * удаление участника из мероприятия - недоделал следующее:
    * принцип тот же самый, что и при удалении мероприятия, но здесь удаляется концевое мероприятие(без потомков)
  * если мероприятие длится больше года - мероприятия разделяются на потомков=количеству лет.
  * обновление участника - здесь скорее всего просто обновить участника с проверкой на наличие нового.
